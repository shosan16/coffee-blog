# CLAUDE.md

## プロジェクト概要

Next.js 15 + TypeScript のコーヒーレシピブログアプリケーション

## 技術スタック

- **フレームワーク**: Next.js 15.3, React 18.3
- **言語**: TypeScript 5.8
- **テスト**: Vitest 3.1, Testing Library
- **バリデーション**: Zod 3.24
- **ログ**: Pino 9.7
- **DB**: Prisma 6.6, PostgreSQL

## 開発コマンド

- `npm run dev` - 開発サーバー起動
- `npm run check-all` - 品質チェック（format, lint, type-check, test）
- `npm run test` - テスト実行
- `npm run build` - ビルド

## 言語設定

- 日本語で回答
- ファイルは UTF-8 エンコーディング

## 開発ワークフロー

**MANDATORY**: 以下のワークフローは例外なく全てのコード変更に適用する。「シンプルな変更」「軽微な修正」という判断でのスキップは禁止。

### フェーズ1: 探索

- [ ] `/context-prime` を実行
- [ ] 変更対象ファイルの特定

### フェーズ2: 設計

- [ ] 設計エージェントを呼び出し
  - `architect`: 構造・データフロー・状態管理・API連携
  - `ui-designer`: 見た目・UX・インタラクション・アクセシビリティ
- [ ] 現状分析・設計・実装計画の立案
- [ ] 計画の確認（ユーザーへの共有）

### フェーズ3: 実装

- [ ] `frontend-developer` または `backend-developer` エージェントを呼び出し
- [ ] TDD で実装
- [ ] `npm run check-all` 成功を確認

### フェーズ4: レビュー

- [ ] `code-reviewer` - コード品質・規約準拠の確認
- [ ] `qa-engineer` - テスト品質・カバレッジの確認
- [ ] `ui-designer` - デザイン一貫性・UX・アクセシビリティの確認（UI変更時）
- [ ] `tech-writer` - ドキュメント・コメントの確認

**判定**: Critical/Warning 指摘があればフェーズ3に戻る

### フェーズ5: 完了

- [ ] `npm run check-all` 最終確認
- [ ] ユーザーにコミット可否を確認
- [ ] コミット・PR 作成（親セッションが実行）

### 役割分担

| 担当         | 作業内容                                |
| ------------ | --------------------------------------- |
| エージェント | ファイルの作成・編集（Write/Edit tool） |
| 親セッション | git 操作（add, commit, push）、PR 作成  |

エージェントは git 操作を行わない。変更完了後、親セッションがコミットを実行する。

### 禁止事項

- エージェントを経由せずに直接コード変更
- 「シンプル」「軽微」を理由にフェーズをスキップ
- 設計フェーズのスキップ
- レビューフェーズのスキップ
- エージェントによる git 操作

## 交渉不可能な制約

### セキュリティ

- 本番環境への操作は明示的なユーザー確認が必要
- シークレットをコードにハードコードしない

### 品質管理

- テスト失敗・リンティングエラーが残るコードは提出しない
- 実装完了後は `npm run check-all` を実行し、通るまで修正

### プロジェクト管理

- タスクスコープ外の変更は行わない
- package.json の技術スタックバージョンを無断変更しない
